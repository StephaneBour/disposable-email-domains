language: php
php:
  - 5.6
  - 7.2

jobs:
  include:
    - stage: PHP Lint
      script:
        - if find . -type f -name "*.php" ! -path "./vendor/*" | xargs -n 1 -P 8 -I % php -d error_reporting=32767 -l % \; 2>&1 >&- | grep "^" ; then exit 1; fi
    - stage: PHP CS Fixer
      install:
        - phpenv config-rm xdebug.ini
        - travis_retry composer install
      script:
        - vendor/bin/php-cs-fixer fix --dry-run -v --show-progress=dots --diff-format=udiff
    - stage: PHP Unit
      install:
        - phpenv config-rm xdebug.ini
        - travis_retry composer install
      script:
        - vendor/bin/phpunit